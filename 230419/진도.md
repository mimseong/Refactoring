## 10장 조건부 로직 간소화

조건부 로직은 프로그램의 힘을 강화하는데 크게 기여하지만, 안타깝게도 프로그램을 복잡하게 만드는 주요 원흉이기도 하다

### 10.1 조건문 분해하기

- 조건과 조건의 본문을 함수로 분해하자
- 조건을 검사하고 그 결과에 따른 동작을 표현한 코드는 무슨 일이 일어나는지 이야기해주지만
- **왜 일어나는지** 제대로 말해주지 않는다
- 코드를 부위별로 분해한 다음 해체된 코드 덩어리들을 각 덩어리의 의도를 살린 이름의 함수 호출로 변경해주자
- 조건이 무엇인지 강조하고, 무엇을 분기했는지 명백해진다

### 10.2 조건식 통합하기

- 결과가 같다면 조건을 통합하자
- 같은 일을 할거라면 조건 검사도 하나로 통합하는게 낫다
- 나뉜 조각을 하나로 통합함으로써 내가 하려는 일이 더 명확해진다

**예시**

- 조건들을 or 연산자로 묶어준다
- 조건문을 함수로 추출한다

### 10.3 중첩 조건문을 보호 구문으로 바꾸기

- 보호구문: 조건이 참이면 함수에서 빠져나온다
- if-else구조: if절과 else절에 똑같은 무개를 두어 코드를 읽는 이에게 양 갈래가 쪽같이 중요하다는 뜻을 전달
- 보호구문: if 확인 후 빠져나온다
- 반환점이 하나여야 한다?
- 반환점이 하나일 때 함수의 로직이 더 명백하다면 그렇게 하자. 그렇지 않다면 하지 말자
- `407p` 함수에서 할 일을 다 마쳤다면 그 사실을 return문으로 명확히 알리는 편이 낫지 않을까?

**예시 - 조건 반대로 만들기**

- 조건에 맞지 않을 경우 return 
- 복잡한 조건은 !() 설정 이후 간소화한다
- 같은 `return` 결과를 내는 조건식을 통합한다
- `result` 변수는 두 가지 일을 한다
  - 보호구문 발동시 반환 값
  - 계산의 최종 결과
- 변수를 제거해서 변수가 한 가지 용도로만 쓰이게 하자

### 10.4 조건부 로직을 다형성으로 바꾸기

**배경**

- 조건문 구조를 그대로 둔 채 해결될 때도 있지만, 클래스와 다형성을 이용하면 더 확실하게 분리할 수도 있다
- 타입을 여러 개 만들고 각 타입이 조건부 로직을 자신만의 방식으로 처리
  - case별로 클래스를 만들어서 공통 switch 로직을 없앨 수 있다
  - 다형성을 활용하여 어떻게 동작할지 각 타입이 알아서 처리
- 기본 동작과 변형 동작으로 구성
  - 기본 동작: 가장 일반적이거나 가장 직관적인 동작
  - 기본 동작을 슈퍼 클래스로 넣는다
  - 변형 동작을 서브클래스로 만들고 기본 동작과 차이를 표현한다
 
**예시**
 
 - 새의 종류에 따라서 비행 속도와 깃털 상태가 다르다
 - 비행 속도와 깃털 상태를 Bird라는 공통 클래스로 묶는다
 - 새의 종 별로 서브 클래스를 만든다
 - 객체를 만드는 팩터리 함수도 추가
 
**덕타이핑이란?**

- 오리처럼 걷고 오리처럼 꽥꽥거리면 그것은 틀림없이 오리다
- 동적 타이핑의 한 종류로 객체의 변수 및 메소드의 집합이 객체의 타입을 결정한다

**예시 - 변형 동작을 다형성으로 표현하기**

- 거의 똑같은 객체지만 다른 부분도 있을을 표현할 때 상속을 쓴다
- `중국까지 항해한 적 있는 선장이 중국을 경유할 때` -> 특수한 상황
- 클래스를 따로 분리해서 상속받는다

### 10.5 특이 케이스 추가하기

- 특이 케이스 패턴
- 특이 케이스를 확인한 다음 특이 케이스만의 동작을 하는 코드들이 곳곳에 등장
  - 단순히 데이터를 읽기만 하는 경우 리터럴 객체 사용 `{}`
  - 다른 동작을 수행하는 경우 필요 메서드를 담은 객체 생성
  - 변환 함수로 데이터 구조에 추가시키는 형태

**예시**

- 코드 곳곳에서 미확인 고객을 예외 처리하고 있다
- 많은 곳들에서 이뤄지는 특이 케이스 검사와 공통된 동작이 특이 케이스 객체 도입을 이야기

```
enrichSite()
enrich: 본질은 같고 부가적인 정보만 덧붙인다
transform: 형태가 변한다
```

### 10.6 어서션 추가하기

- 어서션: 항상 참이라고 가정하는 조건부 문장
- 어서션이 실패한 경우: 프로그래머가 잘못했다
- 어서션을 프로그램이 어떤 상태임을 가정한 채 실행되는지를 다른 개발자들에게 알려주는 소통 도구

**예시**

- 어서션을 세터에 추가하는게 나아 보인다
- 세터로 설정할 때부터 양수인지 검사하는게 문제를 빠르게 찾을 수 있다
- 어서션 남발 역시 위험하다
- 프로그래머가 일으킬만한 오류에만 어서션을 사용한다
- 외부에서 읽어온 값 검사는 예외로 대응해야 하는 로직의 일부이다

### 10.7 제어 플래그를 탈출문으로 바꾸기

- 제어플래그: 코드의 동작을 변경하는 데 사용되는 변수
- `if (...) flag = true`


